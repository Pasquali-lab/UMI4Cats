<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>UMI4C-class — UMI4C • UMI4Cats</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="UMI4C-class — UMI4C" />
<meta property="og:description" content="The UMI4C constructor is the function makeUMI4C. By using
 the arguments listed below, performs the necessary steps to analyze UMI-4C
 data and summarize it in an object of class UMI4C." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">UMI4Cats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/umi4cats-usage.html">Analyzing UMI-4C data with UMI4Cats</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://gitlab.com/pasquali-lab/umi4cats/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>UMI4C-class</h1>
    <small class="dont-index">Source: <a href='https://gitlab.com/pasquali-lab/umi4cats/blob/master/R/AllClasses.R'><code>R/AllClasses.R</code></a></small>
    <div class="hidden name"><code>UMI4C.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The UMI4C constructor is the function <code>makeUMI4C</code>. By using
 the arguments listed below, performs the necessary steps to analyze UMI-4C
 data and summarize it in an object of class UMI4C.</p>
    </div>

    <pre class="usage"><span class='fu'>makeUMI4C</span>(
  <span class='no'>colData</span>,
  <span class='kw'>viewpoint_name</span> <span class='kw'>=</span> <span class='st'>"Unknown"</span>,
  <span class='kw'>grouping</span> <span class='kw'>=</span> <span class='st'>"condition"</span>,
  <span class='kw'>normalized</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>ref_umi4c</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>bait_exclusion</span> <span class='kw'>=</span> <span class='fl'>3000</span>,
  <span class='kw'>bait_expansion</span> <span class='kw'>=</span> <span class='fl'>1e+06</span>,
  <span class='kw'>scales</span> <span class='kw'>=</span> <span class='fl'>5</span>:<span class='fl'>150</span>,
  <span class='kw'>min_win_factor</span> <span class='kw'>=</span> <span class='fl'>0.02</span>,
  <span class='kw'>sd</span> <span class='kw'>=</span> <span class='fl'>2</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>colData</th>
      <td><p>Data.frame containing the information for constructing the
UMI4C experiment object. Needs to contain the following columns:</p><ul>
<li><p>sampleID. Unique identifier for the sample.</p></li>
<li><p>condition. Condition for performing differential analysis. Can be
    control and treatment, two different cell types, etc.</p></li>
<li><p>replicate. Number for identifying replicates.</p></li>
<li><p>file. File as outputed by <code>umi4CatsContacts</code> function.</p></li>
</ul></td>
    </tr>
    <tr>
      <th>viewpoint_name</th>
      <td><p>Character indicating the name for the used viewpoint.</p></td>
    </tr>
    <tr>
      <th>grouping</th>
      <td><p>Name of the column in colData used to merge the samples or
replicates. Default: "condition".</p></td>
    </tr>
    <tr>
      <th>normalized</th>
      <td><p>Logical indicating whether UMI-4C profiles should be
normalized to the <code>ref_umi4c</code> sample/group. Default: TRUE</p></td>
    </tr>
    <tr>
      <th>ref_umi4c</th>
      <td><p>Name of the sample or group to use as reference for
normalization. By default is NULL, which means it will use the sample with
less UMIs in the analyzed region. It should be one of the values from the
column used as <code>grouping</code>.</p></td>
    </tr>
    <tr>
      <th>bait_exclusion</th>
      <td><p>Region around the bait (in bp) to be excluded from the
analysis. Default: 3000bp.</p></td>
    </tr>
    <tr>
      <th>bait_expansion</th>
      <td><p>Number of bp upstream and downstream of the bait to use
for the analysis (region centered in bait). Default: 1Mb.</p></td>
    </tr>
    <tr>
      <th>scales</th>
      <td><p>Numeric vector containing the scales for calculating the
domainogram.</p></td>
    </tr>
    <tr>
      <th>min_win_factor</th>
      <td><p>Proportion of UMIs that need to be found in a specific
window for adaptative trend calculation</p></td>
    </tr>
    <tr>
      <th>sd</th>
      <td><p>Stantard deviation for adaptative trend.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>It returns an object of the class UMI4C.</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    

<dl>
<dt><code>colData</code></dt><dd><p>Data.frame containing the information for constructing the
UMI4C experiment object. Needs to contain the following columns:
<ul>
<li><p><code>sampleID</code>: Unique identifier for the sample.</p></li>
<li><p><code>condition</code>: Condition for performing differential analysis.
    Can be control and treatment, two different cell types, etc.</p></li>
<li><p><code>replicate</code>: Number or ID for identifying different replicates.</p></li>
<li><p><code>file</code>: Path to the files outputed by <code><a href='contactsUMI4C.html'>contactsUMI4C</a></code>.</p></li>
</ul></p></dd>

<dt><code>rowRanges</code></dt><dd><p>GRanges object with the coordinates for
the restriction fragment ends, their IDs and other additional annotation columns.</p></dd>

<dt><code>metadata</code></dt><dd><p>List containing the following elements:
<ol>
<li><p><code>bait</code>: GRanges object representing the position
     of the bait used for the analysis.</p></li>
<li><p><code>scales</code>: Numeric vector containing the scales used for
    calculating the domainogram.</p></li>
<li><p><code>min_win_factor</code>: Factor for calculating the minimum molecules
     requiered in a window for not merging it with the next one when
     calculating the adaptative smoothing trend.</p></li>
<li><p><code>grouping</code>: Column in <code>colData</code> used to group the samples.</p></li>
<li><p><code>normalized</code>: Logical indicating whether samples/groups are
     normalized or not.</p></li>
<li><p><code>region</code>: GRanges with the coordinates of
    the genomic window used for analyzing UMI4C data.</p></li>
<li><p><code>ref_umi4c</code>: Name of the sample or group used as reference for
    normalization.</p></li>
</ol></p></dd>

<dt><code>assays</code></dt><dd><p>Matrix where each row represents a restriction fragment site
and columns represent each sample or group defined in <code>grouping</code>.
After running the <code>makeUMI4C</code> function, it will contain the
following data:
<ol>
<li><p><code>umis</code>: Raw number of UMIs detected by <code><a href='contactsUMI4C.html'>contactsUMI4C</a></code>.</p></li>
<li><p><code>norm_mat</code>: Normalization factors for each sample/group and fragment end.</p></li>
<li><p><code>trend</code>: Adaptative smoothing trend of UMIs.</p></li>
<li><p><code>geo_coords</code>: Geometric coordinates obtained when performing
    the adaptative smoothing.</p></li>
<li><p><code>scale</code>: Scale selected for the adaptative smoothing.</p></li>
<li><p><code>sd</code>: Stantard deviation for the adaptative smoothing trend.</p></li>
</ol></p></dd>

<dt><code>dgram</code></dt><dd><p>List containing the domainograms for each sample. A domainogram
is matrix where columns are different scales selected for merging UMI counts
and rows are the restriction fragments.</p></dd>

<dt><code>results</code></dt><dd><p>List containing the results for the differential analysis ran
using <code><a href='fisherUMI4C.html'>fisherUMI4C</a></code>.</p></dd>

</dl>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The <code>UMI4C</code> class extends the SummarizedExperiment class.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>UMI4C-methods</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Load sample processed file paths</span>
<span class='no'>files</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"CIITA"</span>, <span class='st'>"count"</span>,
    <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"UMI4Cats"</span>
),
<span class='kw'>pattern</span> <span class='kw'>=</span> <span class='st'>"*_counts.tsv"</span>,
<span class='kw'>full.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>
)

<span class='co'># Create colData including all relevant information</span>
<span class='no'>colData</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(
    <span class='kw'>sampleID</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/grep.html'>gsub</a></span>(<span class='st'>"_counts.tsv.gz"</span>, <span class='st'>""</span>, <span class='fu'><a href='https://rdrr.io/r/base/basename.html'>basename</a></span>(<span class='no'>files</span>)),
    <span class='kw'>file</span> <span class='kw'>=</span> <span class='no'>files</span>,
    <span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)

<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>tidyr</span>)</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘tidyr’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:S4Vectors’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    expand</span></div><div class='input'><span class='no'>colData</span> <span class='kw'>&lt;-</span> <span class='no'>colData</span> <span class='kw'>%&gt;%</span>
    <span class='fu'><a href='https://tidyr.tidyverse.org/reference/separate.html'>separate</a></span>(<span class='no'>sampleID</span>,
        <span class='kw'>into</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"condition"</span>, <span class='st'>"replicate"</span>, <span class='st'>"viewpoint"</span>),
        <span class='kw'>remove</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
    )

<span class='co'># Load UMI-4C data and generate UMI4C object</span>
<span class='no'>umi</span> <span class='kw'>&lt;-</span> <span class='fu'>makeUMI4C</span>(
    <span class='kw'>colData</span> <span class='kw'>=</span> <span class='no'>colData</span>,
    <span class='kw'>viewpoint_name</span> <span class='kw'>=</span> <span class='st'>"CIITA"</span>,
    <span class='kw'>grouping</span> <span class='kw'>=</span> <span class='st'>"condition"</span>
)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mireia Ramos-Rodriguez, Marc Subirana-Granes.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


